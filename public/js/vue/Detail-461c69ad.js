import e from"./Layout-28661c09.js";import{r as l,o as t,h as s,f as o,a,w as n,t as i,d,F as c,l as u,k as r}from"./app-f5e6873e.js";const m={class:"mainAppWrapper d-flex flex-column"},h={class:"mainBarWrapper px-5 pt-3 flex-grow-0 flex-shrink-0"},b={class:"d-flex justify-space-between"},p={class:"--left d-flex"},f={class:"--left d-flex me-4"},v={class:"--listing"},g={class:"d-flex flex-1-0 flex-column w-0"},j=o("span",null,"Roles",-1),A={class:"--objectTitle"},D={class:"--right"},k=o("span",{class:"--text"},"Basic",-1),C=o("span",{class:"--text"},"Permissions",-1),V={class:"mainContentWrapper detailContentWrapper d-flex flex-grow-1 flex-shrink-1 overflow-hidden"},w={class:"detailFormWrapper pa-5 flex-grow-1 overflow-auto"},x={class:"componentLayout-tabPanel"},_={class:"--listing"},O=o("thead",null,[o("tr",null,[o("th",null,"Documents"),o("th",null,"All"),o("th",null,"List"),o("th",null,"View"),o("th",null,"Save"),o("th",null,"Publish"),o("th",null,"UnPublish"),o("th",null,"Delete"),o("th",null,"Create")])],-1),S=o("td",null,"All",-1),y=o("thead",null,[o("tr",null,[o("th",null,"Object"),o("th",null,"All"),o("th",null,"List"),o("th",null,"View"),o("th",null,"Save"),o("th",null,"Publish"),o("th",null,"UnPublish"),o("th",null,"Delete"),o("th",null,"Create")])],-1),R=o("thead",null,[o("tr",null,[o("th",null,"Assets"),o("th",null,"All"),o("th",null,"List"),o("th",null,"View"),o("th",null,"Save"),o("th",null,"Publish"),o("th",null,"UnPublish"),o("th",null,"Delete"),o("th",null,"Create")])],-1),P=o("td",null,"Assets",-1),U={data(){var e=[],l=[];return this.objectSetting.forEach((t=>{var s=this.role.splitArrPermission?this.role.splitArrPermission.object.filter((e=>e.includes(t.name+"Object"))):[];console.log(s),t.name,e=[t.name+"ObjectList",t.name+"ObjectView",t.name+"ObjectSave",t.name+"ObjectPublish",t.name+"ObjectUnPublish",t.name+"ObjectDelete",t.name+"ObjectCreate"],t.name,l.push({objArr:e,vmodelObjSelected:!1,vmodelObjArr:s,objName:t.name})})),{toast:r.useToast({position:"top-right",style:{zIndex:"200"}}),showDeleteDialog:!1,tabPermission:null,tab:this.tab||null,name:[e=>!!e||"Required."],documentRoles:["homeDocumentList","homeDocumentView","homeDocumentSave","homeDocumentPublish","homeDocumentUnPublish","homeDocumentDelete","homeDocumentCreate"],docRoleSelected:this.role.splitArrPermission.document,objectRoleSelected:[],assetsRoleSelected:this.role.splitArrPermission.assets,assetsRoles:["assetsList","assetsView","assetsSave","assetsPublish","assetsUnPublish","assetsDelete","assetsCreate"],selectAllDocument:!1,selectAllAssets:!1,objectOptions:l,toast:r.useToast()}},mounted(){this.checkIfAllAssetsChecked(),this.checkIfAllDocumentChecked(),this.objectSetting.forEach((e=>{this.checkIfAllObjectChecked(e)}))},watch:{},methods:{backToListing(){this.$inertia.visit(route("role_listing"))},showDeleteConfirmationDialog(e){this.itemToDelete=e,this.showDeleteDialog=!0},deleteItem(){const e=new FormData;e.append("id",this.itemToDelete),this.$inertia.post(route("role_delete"),e),this.showDeleteDialog=!1},closeDeleteDialog(){this.showDeleteDialog=!1,this.itemToDelete=null},save(e){this.objectOptions.forEach((e=>{this.objectRoleSelected=this.objectRoleSelected.concat(e.vmodelObjArr)})),this.role.permission=[...this.docRoleSelected,...this.objectRoleSelected,...this.assetsRoleSelected];const l=new FormData;l.append("name",this.role.name),l.append("permission",this.role.permission),fetch(route("role_detail",{id:this.role.id}),{method:"POST",body:l}).then((e=>{if(e.ok)return e.json();throw new Error("Lỗi xảy ra khi gửi yêu cầu.")})).then((e=>{e.warning?this.warningMess(e.warning):(this.successMess("Update role success!"),this.$inertia.get(route("role_detail",{id:this.role.id})))})).catch((e=>{console.error("Lỗi xảy ra khi gửi yêu cầu:",e)})).finally((()=>{this.loading=!1}))},toggleAllCheckboxesDocument(){this.docRoleSelected=this.selectAllDocument?this.documentRoles.slice():[]},checkIfAllDocumentChecked(){this.selectAllDocument=this.docRoleSelected.length==this.documentRoles.length},toggleAllCheckboxesAssets(){this.assetsRoleSelected=this.selectAllAssets?this.assetsRoles.slice():[]},checkIfAllAssetsChecked(){this.selectAllAssets=this.assetsRoleSelected.length==this.assetsRoles.length},checkIfAllObjectChecked(e,l){this.objectOptions.forEach((l=>{e==l.objName&&(l.vmodelObjSelected=l.vmodelObjArr.length==l.objArr.length)}))},toggleAllCheckboxesObject(e){this.objectOptions.forEach((l=>{e==l.objName&&(l.vmodelObjArr=l.vmodelObjSelected?l.objArr.slice():[])}))},warningMess(e){e&&setTimeout((()=>{this.toast.open({message:e,type:"warning"})}),1e3)},successMess(e){e&&setTimeout((()=>{this.toast.open({message:e,type:"success"})}),1e3)}}},I=Object.assign(U,{layout:e},{__name:"Detail",props:{role:{permission:{}},flash:Object,objectSetting:Array,tab:String},setup:e=>(r,U)=>{const I=l("v-icon"),L=l("v-breadcrumbs-item"),T=l("v-breadcrumbs"),F=l("v-btn"),N=l("v-toolbar-title"),W=l("v-toolbar"),E=l("v-card-text"),M=l("v-card-actions"),q=l("v-card"),B=l("v-dialog"),$=l("v-tab"),z=l("v-tabs"),G=l("Input"),H=l("v-col"),J=l("v-row"),K=l("v-window-item"),Q=l("v-checkbox"),X=l("Checkbox"),Y=l("v-table"),Z=l("v-window");return t(),s("div",m,[o("div",h,[o("div",b,[o("div",p,[o("div",f,[o("div",{class:"--objectIcon me-3",disabled:!1,onClick:U[0]||(U[0]=(...e)=>r.backToListing&&r.backToListing(...e))},[o("div",v,[a(I,{icon:"mdi-shield-account-outline"}),a(I,{icon:"mdi-arrow-left"}),a(I,{icon:"mdi-shield-account-outline"})])]),o("div",g,[a(T,{class:"breadcrumbWrapper pa-0"},{default:n((()=>[a(L,{class:"--itemBreadcrumb",disabled:!1,onClick:r.backToListing,title:"Roles"},{default:n((()=>[j])),_:1},8,["onClick"])])),_:1}),o("h3",A,i(e.role.name),1)])])]),o("div",D,[a(F,{class:"btn-primary me-2",variant:"elevated","prepend-icon":"mdi-check",onClick:U[1]||(U[1]=e=>r.save())},{default:n((()=>[d(" Save ")])),_:1}),a(F,{variant:"elevated",class:"bg-red","prepend-icon":"mdi-delete-outline",onClick:U[2]||(U[2]=l=>r.showDeleteConfirmationDialog(e.role.id))},{default:n((()=>[d(" Delete ")])),_:1}),a(B,{modelValue:r.showDeleteDialog,"onUpdate:modelValue":U[3]||(U[3]=e=>r.showDeleteDialog=e),"max-width":"300"},{default:n((()=>[a(q,null,{default:n((()=>[a(W,{color:"red-lighten-5",density:"compact"},{default:n((()=>[a(N,{text:"Delete",class:"text-red-darken-1"})])),_:1}),a(E,{class:"py-8"},{default:n((()=>[d(" Are you sure you want to delete? ")])),_:1}),a(M,{class:"justify-end"},{default:n((()=>[a(F,{color:"",variant:"text",onClick:r.closeDeleteDialog},{default:n((()=>[d("Close ")])),_:1},8,["onClick"]),a(F,{variant:"elevated",color:"red-darken-1",onClick:r.deleteItem},{default:n((()=>[d(" Delete ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])]),a(z,{modelValue:r.tab,"onUpdate:modelValue":U[4]||(U[4]=e=>r.tab=e),class:"mainTabPanel"},{default:n((()=>[a($,{value:"information"},{default:n((()=>[k])),_:1}),a($,{value:"permission"},{default:n((()=>[C])),_:1})])),_:1},8,["modelValue"])]),o("div",V,[o("div",w,[o("div",x,[o("form",{onSubmit:U[15]||(U[15]=(...e)=>r.submitForm&&r.submitForm(...e))},[a(Z,{modelValue:r.tab,"onUpdate:modelValue":U[14]||(U[14]=e=>r.tab=e)},{default:n((()=>[a(K,{value:"information"},{default:n((()=>[a(J,null,{default:n((()=>[a(H,{cols:"12"},{default:n((()=>[a(G,{name:"Role Name",label:"Role Name",rules:r.name,modelValue:e.role.name,"onUpdate:modelValue":U[5]||(U[5]=l=>e.role.name=l),class:"--fieldRequired"},null,8,["rules","modelValue"])])),_:1})])),_:1})])),_:1}),a(K,{value:"permission",class:"userPermissionWrapper"},{default:n((()=>[o("div",_,[a(z,{modelValue:r.tabPermission,"onUpdate:modelValue":U[6]||(U[6]=e=>r.tabPermission=e),direction:"horizontal","background-color":"primary"},{default:n((()=>[a($,{value:"documents"},{default:n((()=>[a(I,{start:""},{default:n((()=>[d(" mdi-file-document-outline ")])),_:1}),d(" Documents ")])),_:1}),a($,{value:"object"},{default:n((()=>[a(I,{start:""},{default:n((()=>[d(" mdi-cube-outline ")])),_:1}),d(" Object ")])),_:1}),a($,{value:"assets"},{default:n((()=>[a(I,{start:""},{default:n((()=>[d(" mdi-image ")])),_:1}),d(" Assets ")])),_:1})])),_:1},8,["modelValue"]),a(Z,{modelValue:r.tabPermission,"onUpdate:modelValue":U[13]||(U[13]=e=>r.tabPermission=e)},{default:n((()=>[a(K,{value:"documents",class:"pa-0"},{default:n((()=>[a(Y,{"fixed-header":""},{default:n((()=>[O,o("tbody",null,[o("tr",null,[S,o("td",null,[a(Q,{modelValue:r.selectAllDocument,"onUpdate:modelValue":U[7]||(U[7]=e=>r.selectAllDocument=e),onChange:U[8]||(U[8]=e=>r.toggleAllCheckboxesDocument()),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue"])]),(t(!0),s(c,null,u(r.documentRoles,(e=>(t(),s("td",null,[a(X,{modelValue:r.docRoleSelected,"onUpdate:modelValue":U[9]||(U[9]=e=>r.docRoleSelected=e),value:e,label:"",type:"multi",onChange:r.checkIfAllDocumentChecked},null,8,["modelValue","value","onChange"])])))),256))])])])),_:1})])),_:1}),a(K,{value:"object",class:"pa-0"},{default:n((()=>[a(Y,{"fixed-header":""},{default:n((()=>[y,o("tbody",null,[(t(!0),s(c,null,u(r.objectOptions,((e,l)=>(t(),s("tr",null,[o("td",null,i(e.objName),1),o("td",null,[a(Q,{modelValue:e.vmodelObjSelected,"onUpdate:modelValue":l=>e.vmodelObjSelected=l,onChange:l=>r.toggleAllCheckboxesObject(e.objName),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue","onUpdate:modelValue","onChange"])]),(t(!0),s(c,null,u(e.objArr,(l=>(t(),s("td",null,[a(X,{modelValue:e.vmodelObjArr,"onUpdate:modelValue":l=>e.vmodelObjArr=l,value:l,type:"multi",label:"",onChange:t=>r.checkIfAllObjectChecked(e.objName,l)},null,8,["modelValue","onUpdate:modelValue","value","onChange"])])))),256))])))),256))])])),_:1})])),_:1}),a(K,{value:"assets",class:"pa-0"},{default:n((()=>[a(Y,{"fixed-header":""},{default:n((()=>[R,o("tbody",null,[o("tr",null,[P,o("td",null,[a(Q,{modelValue:r.selectAllAssets,"onUpdate:modelValue":U[10]||(U[10]=e=>r.selectAllAssets=e),onChange:U[11]||(U[11]=e=>r.toggleAllCheckboxesAssets()),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue"])]),(t(!0),s(c,null,u(r.assetsRoles,(e=>(t(),s("td",null,[a(X,{modelValue:r.assetsRoleSelected,"onUpdate:modelValue":U[12]||(U[12]=e=>r.assetsRoleSelected=e),value:e,type:"multi",label:"",onChange:r.checkIfAllAssetsChecked},null,8,["modelValue","value","onChange"])])))),256))])])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1},8,["modelValue"])],32)])])])])}});export{I as default};
