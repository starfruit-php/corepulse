import{am as e,o as t,c as l,C as i,q as s,N as o,M as a,E as d,a as r,k as n,K as p,p as m,z as c,L as u,J as h,m as f}from"./@vue-9ee83fb6.js";import g from"./Layout-8c51cdb8.js";import{V as y}from"./vue-draggable-next-3bc70602.js";import{b as w,c as v,M as b}from"./app-0745d670.js";import{d as x}from"./vue-toast-notification-f2a3de7a.js";import j from"./ModalEditName-92f19fd0.js";import{v as I}from"./vue-filepond-82332930.js";import"./filepond-136e7cc4.js";import{p as F}from"./filepond-plugin-image-preview-4f29f0b3.js";import{p as _}from"./filepond-plugin-file-validate-type-324437b8.js";import"./@vueuse-3c3b27e0.js";import"./unidecode-5a54da0f.js";import"./@ckeditor-fa9b3055.js";import"./vue-abe8eda6.js";import"./ckeditor5-custom-build-7f9f8982.js";import"./vue3-treeview-e35ab4eb.js";import"./mapbox-gl-38e32bee.js";/* empty css             */import"./vuetify-193e6d04.js";import"./@inertiajs-d76518b1.js";import"./axios-3d65c6bd.js";import"./deepmerge-3a6ffb65.js";import"./side-channel-e57be611.js";import"./get-intrinsic-878e88ff.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-afbcd6f2.js";import"./hasown-c3b72c9b.js";import"./call-bind-36d0f176.js";import"./set-function-length-801a4962.js";import"./define-data-property-daf1763a.js";import"./has-property-descriptors-2aeb73fe.js";import"./gopd-61b1e1fb.js";import"./object-inspect-0fa0b9de.js";import"./nprogress-9c4c7d08.js";import"./lodash.clonedeep-c1370659.js";import"./lodash.isequal-feeae999.js";import"./@vuepic-f846cd73.js";import"./date-fns-421fcf3e.js";import"./@babel-0d6f2215.js";import"./element-plus-e3c76eb0.js";import"./lodash-es-fb3d0246.js";import"./@element-plus-283d896c.js";import"./@popperjs-2d1e819d.js";import"./@ctrl-91de2ec7.js";import"./dayjs-7398d4dd.js";import"./async-validator-8d480e59.js";import"./memoize-one-63ab667a.js";import"./escape-html-5c28ffbb.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-24fcdcc4.js";import"./vue3-apexcharts-663397fa.js";import"./apexcharts-4d1d416c.js";import"./vue-i18n-d397f996.js";import"./@intlify-90b40ed7.js";const k={class:"mainAppWrapper d-flex flex-column"},C={class:"mainBarWrapper px-5 py-3 d-flex justify-space-between align-center flex-grow-0 flex-shrink-0"},D={class:"--left d-flex align-center"},A={class:"--listing"},U={class:"d-flex flex-column me-4"},E=r("span",null,"Home",-1),M=r("span",{class:"--divider"},"·",-1),N=r("span",{class:"--divider"},"·",-1),S=r("h3",{class:"--objectTitle me-4"},"Assets",-1),T={class:"--right"},V={class:"--formContent componentField-input"},P=r("label",null,"Folder Name",-1),L={id:"app"},O=r("div",{class:"utilityBarWrapper flex-grow-0 flex-shrink-0"},null,-1),$={class:"mainContentWrapper px-5 py-4 d-flex flex-column flex-grow-1 flex-shrink-1 overflow-hidden"},R={key:0,class:"tableListingWrapper d-flex flex-column flex-shrink-1 flex-grow-1 overflow-hidden"},W={key:1,class:"gridAssetListingWrapper flex-shrink-1 flex-grow-1 overflow-auto",relative:""},q=I(_,F),z={name:"Asset",components:{draggable:y,FilePond:q},props:{nameParent:Object,listAsset:Array,nameFoldes:String},data(){var e=window.location.href;let t=window.localStorage.getItem(e);t?t=JSON.parse(t):(t=[{title:"File",align:"start",key:"fileName",sortable:!0,removable:!0,handleClick:!0,url:"vuetify_asset_detail"},{title:"Fomat",key:"fomat",sortable:!0,removable:!0},{title:"Type",key:"type",sortable:!0,removable:!0},{title:"Size",key:"size",sortable:!1,removable:!0},{title:"Date created",key:"creationDate",sortable:!0,removable:!0,searchType:"Date"}],window.localStorage.setItem(e,JSON.stringify(t)));var l=[];t.map((e=>{e.removable&&l.push(e)}));var i=[];(this.permission.includes("assetsView")||1==this.defaultAdmin)&&i.push(this.createAction("Detail","mdi-eye-outline","detail","vuetify_asset_detail",!1,!1,!1)),(this.permission.includes("assetsView")||1==this.defaultAdmin)&&i.push(this.createAction("Edit","mdi-pencil-outline","edit",{path:"vuetify_asset_edit_name",parentId:this.folderId_url},j,!1,!1)),(this.permission.includes("assetsDelete")||1==this.defaultAdmin)&&i.push(this.createAction("Delete","mdi-delete-outline","delete","vuetify_asset_delete",v,!0)),i.push(this.createAction("Download","mdi-cloud-download-outline","download",{path:"vuetify_asset_download"},w,!1,!1));var s=[{title:"Delete",icon:"mdi-delete-outline",url:{path:"vuetify_asset_delete",content:{title:"Delete",content:"Are you sure you want to Delete all selected",confirm:"Delete"},data:{test:"1"}},component:b,post:!0,reload:!1}],o=new URLSearchParams(window.location.search),a=o.get("folderId"),d=o.get("layout"),r="/cms/asset/upload-file",n=[];return a&&(console.log(a),n={folderId:a},r="/cms/asset/upload-file?folderId="+a),d&&(n={layout:this.displayType!=d?"list":d}),a&&d&&(n={folderId:a,layout:d}),{ModalSelected:f(b),ModalDelete:f(v),ModalExportImage:f(w),ModalEditName:f(j),fav:!0,menu:!1,message:!1,hints:!0,enabled:!0,object:this.listAsset,itemsPerPage:5,headers:l,desserts:this.listAsset,list:t,dragging:!1,selected:[],routerList:{router:route("vuetify_asset",n)},action:i,showNewFolderDialog:!1,newFolderName:"",displayType:d||"list",contextMenuStates:{},draggedItem:null,targetItem:null,draggedItemId:null,draggedItemIndex:null,isLoadingMoreData:!1,successMessage:null,errorMessage:null,folderNewUpload:[],toast:x.useToast({position:"top-right"}),dialogFilepond:!1,myFiles:[],ulrUpload:r,rules:[e=>!!e||"Required."],selectedAction:s,uploadedFilesCount:0,filesUpload:0,dialogExport:!1,radiosType:1,dialogEdit:!1,folderId_url:a,itemExport:{},itemEdit:{},idUrl:""}},watch:{headers(){}},mounted(){this.$nextTick((()=>{this.$refs.myComponentElement&&window.addEventListener("scroll",this.handleScroll)}))},methods:{createAction:(e,t,l,i,s=!1,o=!0,a=!0,d=!0)=>({title:e,icon:t,key:l,url:i,component:s,post:a,reload:d,multiple:o}),showList(){const e=new URLSearchParams(window.location.search).get("folderId");e&&(this.routerList={router:route("vuetify_asset",{folderId:e})}),this.displayType="list"},showGrid(){this.displayType="grid"},handleModalExport(e){this.dialogExport=!0,this.itemExport=e},handleModalEdit(e){this.dialogEdit=!0,this.idUrl=this.folderId_url,this.itemEdit=e},showContextMenu(e,t){for(const a in this.contextMenuStates)this.contextMenuStates[a].visible=!1;const l=window.innerWidth,i=window.innerHeight;let s=e.clientX,o=e.clientY;e.clientX+300>l&&(s=l-300),e.clientY+300>i&&(o=i-300),this.contextMenuStates[t.id]={x:s+"px",y:o+"px",visible:!0}},handleScroll(){const e=this.$refs.myComponentElement;e.scrollTop,e.clientHeight,e.scrollHeight},onDragStart(e,t){e.dataTransfer.setData("text/plain",t.id),this.draggedItemId=t.id,this.draggedItemIndex=this.listAsset.findIndex((e=>e.id===t.id))},onDragOver(e){e.preventDefault()},onDrop(e,t){e.preventDefault();const l=t.id;if(this.listAsset.findIndex((e=>e.id===l)),this.draggedItemId!==l){const e=new FormData;e.append("id",this.draggedItemId),e.append("parentId",l);let t="",i="";const s=new URLSearchParams(window.location.search),o=s.get("folderId"),a=s.get("layout");o&&(t=o),a&&(i=a),e.append("folderId",t),e.append("layout",i),this.$inertia.post("/cms/asset/move",e),this.draggedItemId=null,this.draggedItemIndex=null}},openNewFolderDialog(){this.showNewFolderDialog=!0},closeNewFolderDialog(){this.showNewFolderDialog=!1,this.newFolderName=""},createNewFolder(){const e=this.newFolderName;if(void 0!==e&&""!==e.trim()){let t="";const l=new URLSearchParams(window.location.search).get("folderId");l&&(t=l);const i=new FormData;i.append("parentId",t),i.append("nameFolder",e),this.$inertia.post("/cms/asset/upload-folder",i),this.newFolderName="",this.showNewFolderDialog=!1,setTimeout((()=>{this.flash.success&&this.toast.open({message:this.flash.success,type:"success"});var e=this.flash.errors.key??"",t=this.flash.errors.message??this.flash.errors;this.flash.errors&&this.toast.open({message:e+" "+t,type:"error"})}),1e3),this.closeNewFolderDialog()}else setTimeout((()=>{this.toast.open({message:"Folder Name is required!",type:"error"})}),1e3)},detailItem(e){const t=e.id,l=new FormData;let i="";const s=new URLSearchParams(window.location.search).get("layout");s&&(i=s),l.append("layout",i),this.$inertia.post("/cms/asset/detail/"+t,l)},exportItem(e){if("folder"!=e.type){var t=e.urlDownload;const l=document.createElement("a");l.href=t,l.download="",document.body.appendChild(l),l.click(),document.body.removeChild(l)}},navigateToFolder(){this.$inertia.post("/cms/asset/listing"),this.ulrUpload="/cms/asset/upload-file"},navigateToFolderChill(e){this.$inertia.post("/cms/asset/listing?folderId="+e.id)},copyToClipboard(e){const t=document.createElement("textarea");t.value=e.raw.publicURL,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},deleteItem(e){const t=e.id,l=new FormData;l.append("id",t);let i="";const s=new URLSearchParams(window.location.search).get("folderId");s&&(i=s),l.append("folderId",i),this.$inertia.post("/cms/asset/delete",l)},extractItem(e){const t=e.id,l=new FormData;l.append("id",t);let i="";const s=new URLSearchParams(window.location.search).get("folderId");s&&(i=s),l.append("folderId",i),this.$inertia.post("/cms/asset/extract-file",l)},handleFilePondInit(){this.$refs.pond.getFiles()},filesChange:function(e,t){window.abc=t;let l=new URLSearchParams(window.location.search).get("folderId");var i=t.file._relativePath;t.setMetadata("parentId",l),i&&t.setMetadata("path",i),this.uploadedFilesCount=0,this.filesUpload++},handleProcessFile(e){if(this.uploadedFilesCount++,this.uploadedFilesCount===this.filesUpload){let e=new URLSearchParams(window.location.search).get("folderId");e?this.$inertia.post("/cms/asset/listing?folderId="+e):this.$inertia.post("/cms/asset/listing"),setTimeout((()=>{this.toast.open({message:"Upload the file successfully",type:"success"}),this.dialogFilepond=!1,this.dialog=!1}),1e3)}}}},B=Object.assign(z,{layout:g},{props:{listAsset:Object,nameParent:Object,totalItems:Number,defaultAdmin:Number,permission:Array,flash:Object,chips:[Object,Array],nameFoldes:String,noOrder:[Object,Array]},setup(f){return(g,y)=>{const v=e("v-alert"),b=e("v-icon"),x=e("v-breadcrumbs-item"),I=e("v-breadcrumbs"),F=e("v-btn"),_=e("v-toolbar-title"),z=e("v-toolbar"),B=e("v-text-field"),H=e("v-card-text"),G=e("v-card-actions"),J=e("v-card"),K=e("v-dialog"),X=e("v-btn-toggle"),Y=e("DataTableServer"),Q=e("v-img"),Z=e("v-list-item-title"),ee=e("v-list-item"),te=e("v-list"),le=e("v-menu");return t(),l(p,null,[g.successMessage?(t(),i(v,{key:0,type:"success",dismissible:""},{default:s((()=>[o(a(g.successMessage),1)])),_:1})):d("",!0),g.errorMessage?(t(),i(v,{key:1,type:"error",dismissible:""},{default:s((()=>[o(a(g.errorMessage),1)])),_:1})):d("",!0),r("div",k,[r("div",C,[r("div",D,[r("div",{class:"--objectIcon me-3",onClick:y[0]||(y[0]=e=>g.back(g.breadcrumb.root.id))},[r("div",A,[n(b,{icon:"mdi-image-outline"}),n(b,{icon:"mdi-arrow-left"}),n(b,{icon:"mdi-image-outline"})])]),r("div",U,[n(I,{class:"breadcrumbWrapper pa-0"},{default:s((()=>[n(x,{class:"--itemBreadcrumb",disabled:!f.nameParent,onClick:g.navigateToFolder,title:"Home"},{default:s((()=>[E])),_:1},8,["disabled","onClick"]),M,(t(!0),l(p,null,m(f.nameParent,((e,o)=>(t(),l(p,{key:o},[e?(t(),i(x,{key:0,onClick:t=>g.navigateToFolderChill(e),class:"--itemBreadcrumb",disabled:e.end},{default:s((()=>[r("span",null,a(e.name),1)])),_:2},1032,["onClick","disabled"])):d("",!0),N],64)))),128))])),_:1}),S])]),r("div",T,[f.permission.includes("assetsCreate")||1==f.defaultAdmin?(t(),i(F,{key:0,class:"btn-primary me-2","prepend-icon":"mdi-cloud-upload",onClick:y[1]||(y[1]=e=>g.dialogFilepond=!0)},{default:s((()=>[o(" Upload ")])),_:1})):d("",!0),f.permission.includes("assetsCreate")||1==f.defaultAdmin?(t(),i(F,{key:1,class:"btn-primary me-2","prepend-icon":"mdi-folder-plus",onClick:g.openNewFolderDialog},{default:s((()=>[o(" New Folder ")])),_:1},8,["onClick"])):d("",!0),r("input",{ref:"fileInput",type:"file",style:{display:"none"},onChange:y[2]||(y[2]=(...e)=>g.handleFileUpload&&g.handleFileUpload(...e))},null,544),n(K,{modelValue:g.showNewFolderDialog,"onUpdate:modelValue":y[4]||(y[4]=e=>g.showNewFolderDialog=e),class:"dialogGeneralWrapper","max-width":"400"},{default:s((()=>[n(J,null,{default:s((()=>[n(z,{density:"compact"},{default:s((()=>[n(_,{text:"Create Folder",class:""})])),_:1}),n(H,null,{default:s((()=>[r("div",V,[P,n(B,{variant:"outlined",density:"compact","bg-color":"white",modelValue:g.newFolderName,"onUpdate:modelValue":y[3]||(y[3]=e=>g.newFolderName=e),rules:[e=>!!e||"Name is required"],required:""},null,8,["modelValue","rules"])])])),_:1}),n(G,{class:"justify-end"},{default:s((()=>[n(F,{color:"",variant:"text",onClick:g.closeNewFolderDialog},{default:s((()=>[o("Cancel ")])),_:1},8,["onClick"]),n(F,{variant:"elevated",class:"btn-primary",onClick:g.createNewFolder},{default:s((()=>[o(" Create ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),n(K,{modelValue:g.dialogFilepond,"onUpdate:modelValue":y[5]||(y[5]=e=>g.dialogFilepond=e),ref:"modalContent",class:"dialog-mediaLibrary",width:"500"},{default:s((()=>[r("div",L,[n(c(q),{name:"test",ref:"pond","label-idle":"Drop files here or <span class='filepond--label-action'>Browse</span>","allow-multiple":!0,server:"/cms/asset/upload-file",files:g.myFiles,onInit:g.handleFilePondInit,onProcessfile:g.handleProcessFile,onAddfile:g.filesChange},null,8,["files","onInit","onProcessfile","onAddfile"])])])),_:1},8,["modelValue"]),n(X,{modelValue:g.displayType,"onUpdate:modelValue":y[6]||(y[6]=e=>g.displayType=e),color:"primary",mandatory:""},{default:s((()=>[n(F,{icon:"list"==g.displayType?"mdi-table":"mdi-table-off",value:"list"},null,8,["icon"]),n(F,{icon:"grid"==g.displayType?"mdi-grid":"mdi-grid-off",value:"grid"},null,8,["icon"])])),_:1},8,["modelValue"])])]),O,r("div",$,["list"===g.displayType?(t(),l("div",R,[n(Y,{listing:f.listAsset,router:g.routerList,"total-items":f.totalItems,headers:g.headers,action:g.action,chips:f.chips,selectedAction:g.selectedAction,noOrder:f.noOrder},null,8,["listing","router","total-items","headers","action","chips","selectedAction","noOrder"])])):d("",!0),"grid"===g.displayType?(t(),l("div",W,[(t(!0),l(p,null,m(f.listAsset,(e=>(t(),i(J,{key:e.id,onContextmenu:h((t=>g.showContextMenu(t,e)),["prevent"]),onClick:t=>g.detailItem(e),class:"itemAssetGrid"},{default:s((()=>[n(Q,{src:e.publicURL,"aspect-ratio":"1",cover:""},null,8,["src"]),n(H,null,{default:s((()=>[o(a(e.file),1)])),_:2},1024),g.contextMenuStates[e.id]?(t(),i(le,{key:0,modelValue:g.contextMenuStates[e.id].visible,"onUpdate:modelValue":t=>g.contextMenuStates[e.id].visible=t,style:u({top:g.contextMenuStates[e.id].y,left:g.contextMenuStates[e.id].x}),absolute:"","offset-y":""},{default:s((()=>[n(te,{density:"compact"},{default:s((()=>[n(ee,{onClick:t=>g.detailItem(e)},{prepend:s((()=>[n(b,{icon:"mdi-eye-outline"})])),default:s((()=>[n(Z,null,{default:s((()=>[o("Detail")])),_:1})])),_:2},1032,["onClick"]),"folder"==e.type?(t(),i(ee,{key:0,onClick:t=>g.handleModalEdit(e)},{prepend:s((()=>[n(b,{icon:"mdi-pencil-outline"})])),default:s((()=>[n(Z,null,{default:s((()=>[o("Edit")])),_:1})])),_:2},1032,["onClick"])):d("",!0),"folder"!=e.type?(t(),i(ee,{key:1,onClick:t=>g.handleModalExport(e)},{prepend:s((()=>[n(b,{icon:"mdi-cloud-download-outline"})])),default:s((()=>[n(Z,null,{default:s((()=>[o("Download")])),_:1})])),_:2},1032,["onClick"])):d("",!0),n(ee,{onClick:t=>g.deleteItem(e)},{prepend:s((()=>[n(b,{icon:"mdi-delete-outline"})])),default:s((()=>[n(Z,null,{default:s((()=>[o("Delete")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","style"])):d("",!0)])),_:2},1032,["onContextmenu","onClick"])))),128)),n(K,{modelValue:g.dialogEdit,"onUpdate:modelValue":y[8]||(y[8]=e=>g.dialogEdit=e),width:"420"},{default:s((()=>[n(J,null,{default:s((()=>[n(j,{"onUpdate:dialog":y[7]||(y[7]=e=>g.dialogEdit=e),item:g.itemEdit,url:{path:"vuetify_asset_edit_name",parentId:this.folderId_url}},null,8,["item","url"])])),_:1})])),_:1},8,["modelValue"]),n(K,{modelValue:g.dialogExport,"onUpdate:modelValue":y[10]||(y[10]=e=>g.dialogExport=e),width:"420"},{default:s((()=>[n(J,null,{default:s((()=>[n(w,{"onUpdate:dialog":y[9]||(y[9]=e=>g.dialogExport=e),item:g.itemExport},null,8,["item"])])),_:1})])),_:1},8,["modelValue"])])):d("",!0)])])],64)}}});export{B as default};
