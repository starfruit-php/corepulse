import e from"./Layout-35f4b0f3.js";import{r as t,o as s,h as l,f as a,a as i,w as o,z as c,d as r,i as n,t as h,c as d,F as u,l as p,B as f,V as v}from"./app-d4bd4684.js";const g={class:"mainAppWrapper adminSettingWrapper d-flex flex-column"},m={class:"mainBarWrapper px-5 pt-3 flex-grow-0 flex-shrink-0"},w={class:"d-flex align-center"},y={class:"--left d-flex align-center"},k=a("div",{class:"d-flex flex-column me-4"},[a("h3",{class:"--objectTitle me-4"},"Plausible Widget")],-1),x={class:"--right"},b={class:"mainContentWrapper px-5 py-4 d-flex flex-column flex-grow-1 flex-shrink-1"},D={class:"d-flex",style:{gap:"10px"}},_=["src"],C={class:"h-100 d-flex flex-column pa-8"},A=a("h3",{class:"mb-4"},"Plausible",-1),S={key:0,class:"total-arr d-flex"},V=["onClick"],P={key:1,class:"flex-1-1 overflow-hidden"},O={class:"h-100 d-flex flex-column pa-8"},j=a("h3",{class:"mb-4"},"Top Pages",-1),W={class:"flex-1-1 overflow-hidden"},T={class:"h-100 d-flex flex-column pa-8"},F=a("h3",{class:"mb-4"},"Sources",-1),I={class:"flex-1-1 overflow-hidden"},B={class:"h-100 d-flex flex-column pa-8"},L={class:"d-flex justify-between"},z=a("h3",{class:"mb-4 order-2"},"Devices",-1),E={key:0,class:"total-arr d-flex order-1"},U=["onClick"],$={key:0,class:"flex-1-1 overflow-hidden"},q={components:{draggable:v},data(){return{menu:!1,chartVies:this.chartVisitors,chartDevis:this.chartDevices,chartOptions:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{}}}},showChart:!0,showChartDevi:!0,keyActive:"visitors",showVisi:!0,showPages:!1,showSources:!1,showDevi:!1,totalDevi:[{title:"browser"},{title:"os"},{title:"size"}],keyDeActive:"browser",url_logo:"",siteId:this.plausibleSetting?this.plausibleSetting.siteId:""}},mounted(){if(this.siteId){const e="https://"+this.siteId;fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.text()})).then((t=>{const s=(new DOMParser).parseFromString(t,"text/html").querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]');let l="";s.length>0&&(l=s[0].getAttribute("href"),this.url_logo=e+l)})).catch((e=>{console.error("Error fetching website data:",e)}))}},methods:{replaceDash:e=>"string"==typeof e?e.replace("_"," "):e,changeData(e){this.showChart=!1;const t=new FormData;t.append("metrics",e),fetch("../cms/get-list-views-plausible",{method:"POST",body:t}).then((e=>e.json())).then((t=>{this.$nextTick((()=>{this.chartVies=t.data,this.showChart=!0,this.keyActive=e}))})).catch((e=>{console.log(e)}))},changeDevi(e){this.showChartDevi=!1;const t=new FormData;t.append("property",e),fetch("../cms/get-list-views-plausible-devi",{method:"POST",body:t}).then((e=>e.json())).then((t=>{this.$nextTick((()=>{this.chartDevis=t.data,this.showChartDevi=!0,this.keyDeActive=e}))})).catch((e=>{console.log(e)}))},overview(){this.showVisi=!this.showVisi},pages(){this.showPages=!this.showPages},devices(){this.showDevi=!this.showDevi},sources(){this.showSources=!this.showSources}}},M=Object.assign(q,{layout:e},{__name:"Widget",props:{chartVisitors:[Object,Array],totalArr:[Object,Array],chartTopPages:[Object,Array],chartDevices:[Object,Array],chartSources:[Object,Array],plausibleSetting:Object},setup:e=>(v,q)=>{const M=t("v-icon"),N=t("v-btn"),R=t("v-list-item-title"),G=t("v-list-item"),H=t("v-list"),J=t("v-card"),K=t("v-menu"),Q=t("v-col"),X=t("LineChart"),Y=t("BarChart"),Z=t("draggable"),ee=t("v-container");return s(),l("div",g,[a("div",m,[a("div",w,[a("div",y,[i(M,{icon:"mdi-widgets",class:"--objectIcon me-3"}),k]),a("div",x,[i(K,{modelValue:v.menu,"onUpdate:modelValue":q[8]||(q[8]=e=>v.menu=e),"close-on-content-click":!1},{activator:o((({props:e})=>[i(N,c({class:"btn-primary me-2",variant:"elevated","prepend-icon":"mdi-plus"},e),{default:o((()=>[r(" Add Portlet ")])),_:2},1040)])),default:o((()=>[i(J,{"min-width":"150"},{default:o((()=>[i(H,null,{default:o((()=>[i(G,{onClick:q[1]||(q[1]=e=>v.overview())},{append:o((()=>[i(M,{onClick:q[0]||(q[0]=e=>v.handleChangeField(v.field.key)),icon:v.showVisi?"mdi-eye":"mdi-eye-off"},null,8,["icon"])])),default:o((()=>[i(R,null,{default:o((()=>[r("Overview")])),_:1})])),_:1}),i(G,{onClick:q[3]||(q[3]=e=>v.pages())},{append:o((()=>[i(M,{onClick:q[2]||(q[2]=e=>v.handleChangeField(v.field.key)),icon:v.showPages?"mdi-eye":"mdi-eye-off"},null,8,["icon"])])),default:o((()=>[i(R,null,{default:o((()=>[r("Top Pages")])),_:1})])),_:1}),i(G,{onClick:q[5]||(q[5]=e=>v.sources())},{append:o((()=>[i(M,{onClick:q[4]||(q[4]=e=>v.handleChangeField(v.field.key)),icon:v.showSources?"mdi-eye":"mdi-eye-off"},null,8,["icon"])])),default:o((()=>[i(R,null,{default:o((()=>[r("Top Sources")])),_:1})])),_:1}),i(G,{onClick:q[7]||(q[7]=e=>v.devices())},{append:o((()=>[i(M,{onClick:q[6]||(q[6]=e=>v.handleChangeField(v.field.key)),icon:v.showDevi?"mdi-eye":"mdi-eye-off"},null,8,["icon"])])),default:o((()=>[i(R,null,{default:o((()=>[r("Devices")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])])]),a("div",b,[i(ee,null,{default:o((()=>[i(Q,{cols:"12"},{default:o((()=>[a("div",D,[v.url_logo?(s(),l("img",{key:0,src:v.url_logo,style:{width:"24px",height:"23px"},alt:"Logo"},null,8,_)):n("",!0),a("h3",null,h(e.plausibleSetting?e.plausibleSetting.siteId:""),1)])])),_:1}),i(Z,{modelValue:v.columns,"onUpdate:modelValue":q[9]||(q[9]=e=>v.columns=e),class:"row draggable-container"},{default:o((()=>[v.chartVies&&v.showVisi?(s(),d(Q,{key:0,cols:"12",class:"draggable-column"},{default:o((()=>[i(J,{class:"itemWidgetWrapper",style:{height:"430px"}},{default:o((()=>[a("div",C,[A,e.totalArr?(s(),l("div",S,[(s(!0),l(u,null,p(e.totalArr,((e,t)=>(s(),l("div",{class:"total-info",key:t},[a("p",{class:f({title:!0,active:t===v.keyActive}),onClick:e=>v.changeData(t)},h(v.replaceDash(t)),11,V),a("p",null,h(e.value),1)])))),128))])):n("",!0),v.showChart?(s(),l("div",P,[i(X,{class:"h-100",chartData:v.chartVies,chartOptions:v.chartOptions},null,8,["chartData","chartOptions"])])):n("",!0)])])),_:1})])),_:1})):n("",!0),e.chartTopPages&&v.showPages?(s(),d(Q,{key:1,cols:"6",class:"draggable-column"},{default:o((()=>[i(J,{class:"itemWidgetWrapper",style:{height:"430px"}},{default:o((()=>[a("div",O,[j,a("div",W,[i(Y,{class:"h-100",chartData:e.chartTopPages},null,8,["chartData"])])])])),_:1})])),_:1})):n("",!0),e.chartSources&&v.showSources?(s(),d(Q,{key:2,cols:"6",class:"draggable-column"},{default:o((()=>[i(J,{class:"itemWidgetWrapper",style:{height:"430px"}},{default:o((()=>[a("div",T,[F,a("div",I,[i(Y,{class:"h-100",chartData:e.chartSources},null,8,["chartData"])])])])),_:1})])),_:1})):n("",!0),v.chartDevis&&v.showDevi?(s(),d(Q,{key:3,cols:"6",class:"draggable-column"},{default:o((()=>[i(J,{class:"itemWidgetWrapper",style:{height:"430px"}},{default:o((()=>[a("div",B,[a("div",L,[z,e.totalArr?(s(),l("div",E,[(s(!0),l(u,null,p(v.totalDevi,((e,t)=>(s(),l("div",{class:"total-info-devi",key:t},[a("p",{class:f({title:!0,active:e.title===v.keyDeActive}),onClick:t=>v.changeDevi(e.title)},h(e.title),11,U)])))),128))])):n("",!0)]),v.showChartDevi?(s(),l("div",$,[i(Y,{class:"h-100",chartData:v.chartDevis},null,8,["chartData"])])):n("",!0)])])),_:1})])),_:1})):n("",!0)])),_:1},8,["modelValue"])])),_:1})])])}});export{M as default};
