import e from"./Layout-b42d48af.js";import{d as l}from"./vue-toast-notification-f2a3de7a.js";import{am as t,o as s,c as o,a,k as n,q as i,M as d,N as c,K as u,p as r}from"./@vue-9ee83fb6.js";import"./@vueuse-3c3b27e0.js";import"./unidecode-5a54da0f.js";import"./@ckeditor-fa9b3055.js";import"./vue-abe8eda6.js";const m={class:"mainAppWrapper d-flex flex-column"},h={class:"mainBarWrapper px-5 pt-3 flex-grow-0 flex-shrink-0"},b={class:"d-flex justify-space-between"},p={class:"--left d-flex"},f={class:"--left d-flex me-4"},v={class:"--listing"},g={class:"d-flex flex-1-0 flex-column w-0"},j=a("span",null,"Roles",-1),A={class:"--objectTitle"},D={class:"--right"},k=a("span",{class:"--text"},"Basic",-1),C=a("span",{class:"--text"},"Permissions",-1),V={class:"mainContentWrapper detailContentWrapper d-flex flex-grow-1 flex-shrink-1 overflow-hidden"},x={class:"detailFormWrapper pa-5 flex-grow-1 overflow-auto"},w={class:"componentLayout-tabPanel"},_={class:"--listing"},S=a("thead",null,[a("tr",null,[a("th",null,"Documents"),a("th",null,"All"),a("th",null,"List"),a("th",null,"View"),a("th",null,"Save"),a("th",null,"Publish"),a("th",null,"UnPublish"),a("th",null,"Delete"),a("th",null,"Create")])],-1),O=a("td",null,"All",-1),y=a("thead",null,[a("tr",null,[a("th",null,"Object"),a("th",null,"All"),a("th",null,"List"),a("th",null,"View"),a("th",null,"Save"),a("th",null,"Publish"),a("th",null,"UnPublish"),a("th",null,"Delete"),a("th",null,"Create")])],-1),R=a("thead",null,[a("tr",null,[a("th",null,"Assets"),a("th",null,"All"),a("th",null,"List"),a("th",null,"View"),a("th",null,"Save"),a("th",null,"Publish"),a("th",null,"UnPublish"),a("th",null,"Delete"),a("th",null,"Create")])],-1),P=a("td",null,"Assets",-1),U={data(){var e=[],t=[];return this.objectSetting.forEach((l=>{var s=this.role.splitArrPermission?this.role.splitArrPermission.object.filter((e=>e.includes(l.name+"Object"))):[];console.log(s),l.name,e=[l.name+"ObjectList",l.name+"ObjectView",l.name+"ObjectSave",l.name+"ObjectPublish",l.name+"ObjectUnPublish",l.name+"ObjectDelete",l.name+"ObjectCreate"],l.name,t.push({objArr:e,vmodelObjSelected:!1,vmodelObjArr:s,objName:l.name})})),{toast:l.useToast({position:"top-right",style:{zIndex:"200"}}),showDeleteDialog:!1,tabPermission:null,tab:this.tab||null,name:[e=>!!e||"Required."],documentRoles:["homeDocumentList","homeDocumentView","homeDocumentSave","homeDocumentPublish","homeDocumentUnPublish","homeDocumentDelete","homeDocumentCreate"],docRoleSelected:this.role.splitArrPermission.document,objectRoleSelected:[],assetsRoleSelected:this.role.splitArrPermission.assets,assetsRoles:["assetsList","assetsView","assetsSave","assetsPublish","assetsUnPublish","assetsDelete","assetsCreate"],selectAllDocument:!1,selectAllAssets:!1,objectOptions:t,toast:l.useToast()}},mounted(){this.checkIfAllAssetsChecked(),this.checkIfAllDocumentChecked(),this.objectSetting.forEach((e=>{this.checkIfAllObjectChecked(e)}))},watch:{},methods:{backToListing(){this.$inertia.visit(route("role_listing"))},showDeleteConfirmationDialog(e){this.itemToDelete=e,this.showDeleteDialog=!0},deleteItem(){const e=new FormData;e.append("id",this.itemToDelete),this.$inertia.post(route("role_delete"),e),this.showDeleteDialog=!1},closeDeleteDialog(){this.showDeleteDialog=!1,this.itemToDelete=null},save(e){this.objectOptions.forEach((e=>{this.objectRoleSelected=this.objectRoleSelected.concat(e.vmodelObjArr)})),this.role.permission=[...this.docRoleSelected,...this.objectRoleSelected,...this.assetsRoleSelected];const l=new FormData;l.append("name",this.role.name),l.append("permission",this.role.permission),fetch(route("role_detail",{id:this.role.id}),{method:"POST",body:l}).then((e=>{if(e.ok)return e.json();throw new Error("Lỗi xảy ra khi gửi yêu cầu.")})).then((e=>{e.warning?this.warningMess(e.warning):(this.successMess("Update role success!"),this.$inertia.get(route("role_detail",{id:this.role.id})))})).catch((e=>{console.error("Lỗi xảy ra khi gửi yêu cầu:",e)})).finally((()=>{this.loading=!1}))},toggleAllCheckboxesDocument(){this.docRoleSelected=this.selectAllDocument?this.documentRoles.slice():[]},checkIfAllDocumentChecked(){this.selectAllDocument=this.docRoleSelected.length==this.documentRoles.length},toggleAllCheckboxesAssets(){this.assetsRoleSelected=this.selectAllAssets?this.assetsRoles.slice():[]},checkIfAllAssetsChecked(){this.selectAllAssets=this.assetsRoleSelected.length==this.assetsRoles.length},checkIfAllObjectChecked(e,l){this.objectOptions.forEach((l=>{e==l.objName&&(l.vmodelObjSelected=l.vmodelObjArr.length==l.objArr.length)}))},toggleAllCheckboxesObject(e){this.objectOptions.forEach((l=>{e==l.objName&&(l.vmodelObjArr=l.vmodelObjSelected?l.objArr.slice():[])}))},warningMess(e){e&&setTimeout((()=>{this.toast.open({message:e,type:"warning"})}),1e3)},successMess(e){e&&setTimeout((()=>{this.toast.open({message:e,type:"success"})}),1e3)}}},I=Object.assign(U,{layout:e},{__name:"Detail",props:{role:{permission:{}},flash:Object,objectSetting:Array,tab:String},setup:e=>(l,U)=>{const I=t("v-icon"),L=t("v-breadcrumbs-item"),T=t("v-breadcrumbs"),N=t("v-btn"),F=t("v-toolbar-title"),W=t("v-toolbar"),E=t("v-card-text"),M=t("v-card-actions"),q=t("v-card"),B=t("v-dialog"),$=t("v-tab"),z=t("v-tabs"),K=t("Input"),G=t("v-col"),H=t("v-row"),J=t("v-window-item"),Q=t("v-checkbox"),X=t("Checkbox"),Y=t("v-table"),Z=t("v-window");return s(),o("div",m,[a("div",h,[a("div",b,[a("div",p,[a("div",f,[a("div",{class:"--objectIcon me-3",disabled:!1,onClick:U[0]||(U[0]=(...e)=>l.backToListing&&l.backToListing(...e))},[a("div",v,[n(I,{icon:"mdi-shield-account-outline"}),n(I,{icon:"mdi-arrow-left"}),n(I,{icon:"mdi-shield-account-outline"})])]),a("div",g,[n(T,{class:"breadcrumbWrapper pa-0"},{default:i((()=>[n(L,{class:"--itemBreadcrumb",disabled:!1,onClick:l.backToListing,title:"Roles"},{default:i((()=>[j])),_:1},8,["onClick"])])),_:1}),a("h3",A,d(e.role.name),1)])])]),a("div",D,[n(N,{class:"btn-primary me-2",variant:"elevated","prepend-icon":"mdi-check",onClick:U[1]||(U[1]=e=>l.save())},{default:i((()=>[c(" Save ")])),_:1}),n(N,{variant:"elevated",class:"bg-red","prepend-icon":"mdi-delete-outline",onClick:U[2]||(U[2]=t=>l.showDeleteConfirmationDialog(e.role.id))},{default:i((()=>[c(" Delete ")])),_:1}),n(B,{modelValue:l.showDeleteDialog,"onUpdate:modelValue":U[3]||(U[3]=e=>l.showDeleteDialog=e),"max-width":"300"},{default:i((()=>[n(q,null,{default:i((()=>[n(W,{color:"red-lighten-5",density:"compact"},{default:i((()=>[n(F,{text:"Delete",class:"text-red-darken-1"})])),_:1}),n(E,{class:"py-8"},{default:i((()=>[c(" Are you sure you want to delete? ")])),_:1}),n(M,{class:"justify-end"},{default:i((()=>[n(N,{color:"",variant:"text",onClick:l.closeDeleteDialog},{default:i((()=>[c("Close ")])),_:1},8,["onClick"]),n(N,{variant:"elevated",color:"red-darken-1",onClick:l.deleteItem},{default:i((()=>[c(" Delete ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])]),n(z,{modelValue:l.tab,"onUpdate:modelValue":U[4]||(U[4]=e=>l.tab=e),class:"mainTabPanel"},{default:i((()=>[n($,{value:"information"},{default:i((()=>[k])),_:1}),n($,{value:"permission"},{default:i((()=>[C])),_:1})])),_:1},8,["modelValue"])]),a("div",V,[a("div",x,[a("div",w,[a("form",{onSubmit:U[15]||(U[15]=(...e)=>l.submitForm&&l.submitForm(...e))},[n(Z,{modelValue:l.tab,"onUpdate:modelValue":U[14]||(U[14]=e=>l.tab=e)},{default:i((()=>[n(J,{value:"information"},{default:i((()=>[n(H,null,{default:i((()=>[n(G,{cols:"12"},{default:i((()=>[n(K,{name:"Role Name",label:"Role Name",rules:l.name,modelValue:e.role.name,"onUpdate:modelValue":U[5]||(U[5]=l=>e.role.name=l),class:"--fieldRequired"},null,8,["rules","modelValue"])])),_:1})])),_:1})])),_:1}),n(J,{value:"permission",class:"userPermissionWrapper"},{default:i((()=>[a("div",_,[n(z,{modelValue:l.tabPermission,"onUpdate:modelValue":U[6]||(U[6]=e=>l.tabPermission=e),direction:"horizontal","background-color":"primary"},{default:i((()=>[n($,{value:"documents"},{default:i((()=>[n(I,{start:""},{default:i((()=>[c(" mdi-file-document-outline ")])),_:1}),c(" Documents ")])),_:1}),n($,{value:"object"},{default:i((()=>[n(I,{start:""},{default:i((()=>[c(" mdi-cube-outline ")])),_:1}),c(" Object ")])),_:1}),n($,{value:"assets"},{default:i((()=>[n(I,{start:""},{default:i((()=>[c(" mdi-image ")])),_:1}),c(" Assets ")])),_:1})])),_:1},8,["modelValue"]),n(Z,{modelValue:l.tabPermission,"onUpdate:modelValue":U[13]||(U[13]=e=>l.tabPermission=e)},{default:i((()=>[n(J,{value:"documents",class:"pa-0"},{default:i((()=>[n(Y,{"fixed-header":""},{default:i((()=>[S,a("tbody",null,[a("tr",null,[O,a("td",null,[n(Q,{modelValue:l.selectAllDocument,"onUpdate:modelValue":U[7]||(U[7]=e=>l.selectAllDocument=e),onChange:U[8]||(U[8]=e=>l.toggleAllCheckboxesDocument()),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue"])]),(s(!0),o(u,null,r(l.documentRoles,(e=>(s(),o("td",null,[n(X,{modelValue:l.docRoleSelected,"onUpdate:modelValue":U[9]||(U[9]=e=>l.docRoleSelected=e),value:e,label:"",type:"multi",onChange:l.checkIfAllDocumentChecked},null,8,["modelValue","value","onChange"])])))),256))])])])),_:1})])),_:1}),n(J,{value:"object",class:"pa-0"},{default:i((()=>[n(Y,{"fixed-header":""},{default:i((()=>[y,a("tbody",null,[(s(!0),o(u,null,r(l.objectOptions,((e,t)=>(s(),o("tr",null,[a("td",null,d(e.objName),1),a("td",null,[n(Q,{modelValue:e.vmodelObjSelected,"onUpdate:modelValue":l=>e.vmodelObjSelected=l,onChange:t=>l.toggleAllCheckboxesObject(e.objName),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue","onUpdate:modelValue","onChange"])]),(s(!0),o(u,null,r(e.objArr,(t=>(s(),o("td",null,[n(X,{modelValue:e.vmodelObjArr,"onUpdate:modelValue":l=>e.vmodelObjArr=l,value:t,type:"multi",label:"",onChange:s=>l.checkIfAllObjectChecked(e.objName,t)},null,8,["modelValue","onUpdate:modelValue","value","onChange"])])))),256))])))),256))])])),_:1})])),_:1}),n(J,{value:"assets",class:"pa-0"},{default:i((()=>[n(Y,{"fixed-header":""},{default:i((()=>[R,a("tbody",null,[a("tr",null,[P,a("td",null,[n(Q,{modelValue:l.selectAllAssets,"onUpdate:modelValue":U[10]||(U[10]=e=>l.selectAllAssets=e),onChange:U[11]||(U[11]=e=>l.toggleAllCheckboxesAssets()),type:"multi","hide-details":"",class:"--formContent componentField-checkbox"},null,8,["modelValue"])]),(s(!0),o(u,null,r(l.assetsRoles,(e=>(s(),o("td",null,[n(X,{modelValue:l.assetsRoleSelected,"onUpdate:modelValue":U[12]||(U[12]=e=>l.assetsRoleSelected=e),value:e,type:"multi",label:"",onChange:l.checkIfAllAssetsChecked},null,8,["modelValue","value","onChange"])])))),256))])])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1},8,["modelValue"])],32)])])])])}});export{I as default};
